<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ”ª Jeu des Assassins</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap');
    
    * { box-sizing: border-box; }
    body { 
      font-family: 'Crimson Text', serif; 
      max-width: 600px; 
      margin: 50px auto; 
      padding: 20px; 
      background: linear-gradient(135deg, #1a0000 0%, #2d0a0a 50%, #4a0000 100%);
      color: #f0e6d2;
      min-height: 100vh;
    }
    h1 {
      text-align: center;
      color: #ff4444;
      text-shadow: 0 0 20px #8b0000, 2px 2px 4px rgba(0,0,0,0.8);
      font-size: 2.2em;
      font-weight: 600;
      margin-bottom: 30px;
      letter-spacing: 2px;
    }
    input, select { 
      padding: 15px; 
      font-size: 18px; 
      width: 100%; 
      max-width: 300px;
      margin: 12px 0;
      border: 2px solid #660000;
      border-radius: 8px;
      background: rgba(255,255,255,0.1);
      color: #f0e6d2;
      font-family: inherit;
    }
    input::placeholder {
      color: rgba(240,230,210,0.7);
    }
    button { 
      padding: 15px 28px; 
      font-size: 18px; 
      cursor: pointer; 
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-family: inherit;
      transition: all 0.3s;
      margin: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    button:hover, button:active {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(255,68,68,0.4);
    }
    #initBtn { 
      background: linear-gradient(45deg, #b71c1c, #d32f2f);
      color: #fff;
      box-shadow: 0 4px 15px rgba(183,28,28,0.5);
      display: block;
      margin: 0 auto 20px;
    }
    #verifyBtn { 
      background: linear-gradient(45deg, #333, #555);
      color: #fff;
      box-shadow: 0 4px 15px rgba(51,51,51,0.5);
    }
    pre { 
      background: rgba(20,0,0,0.95); 
      padding: 35px; 
      border-radius: 12px; 
      margin-top: 25px; 
      box-shadow: 0 8px 30px rgba(0,0,0,0.8);
      font-size: 16px;
      min-height: 140px;
      white-space: pre-wrap;
      line-height: 1.7;
      border: 2px solid #660000;
      color: #f0e6d2;
    }
    .section { margin-bottom: 45px; text-align: center; }
    .form-row { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; align-items: center; }
    .hidden { display: none !important; }
    .joueur-input { margin: 10px 0; width: 100%; max-width: 300px; }
    .form-buttons { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
  </style>
</head>
<body>
  <h1>ğŸ”ª Jeu des Assassins</h1>
  
  <div class="section">
    <button id="initBtn">ğŸ” Nouvelle partie</button>
    <div id="initForm" class="hidden">
      <select id="nbJoueurs">
        <option value="">Combien de joueurs ?</option>
        <option value="3">3 joueurs</option>
        <option value="4">4 joueurs</option>
        <option value="5">5 joueurs</option>
        <option value="6">6 joueurs</option>
        <option value="7">7 joueurs</option>
        <option value="8">8 joueurs</option>
        <option value="9">9 joueurs</option>
        <option value="10">10 joueurs</option>
        <option value="11">11 joueurs</option>
        <option value="12">12 joueurs</option>
        <option value="13">13 joueurs</option>
        <option value="14">14 joueurs</option>
        <option value="15">15 joueurs</option>
        <option value="16">16 joueurs</option>
        <option value="17">17 joueurs</option>
        <option value="18">18 joueurs</option>
        <option value="19">19 joueurs</option>
        <option value="20">20 joueurs</option>
      </select>
      <div id="joueursInputs"></div>
      <div class="form-buttons">
        <button id="confirmBtn">âš¡ Commencer le massacre</button>
        <button id="cancelBtn">âŒ Annuler</button>
      </div>
    </div>
  </div>

  <div class="section">
    <div class="form-row">
      <input type="text" id="nomInput" placeholder="Votre nom...">
      <button id="verifyBtn" class="hidden">ğŸ” Ma cible</button>
    </div>
  </div>
  
  <pre id="resultat">ğŸ”ª Cliquez sur "Nouvelle partie" pour commencer le massacre...</pre>

  <script>
    let joueursMeles = [];
    let jeuInitialise = false;

    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('initBtn').addEventListener('click', showInitForm);
      document.getElementById('confirmBtn').addEventListener('click', commencerPartie);
      document.getElementById('cancelBtn').addEventListener('click', hideInitForm);
      document.getElementById('verifyBtn').addEventListener('click', verifier);
      document.getElementById('nomInput').addEventListener('input', function() {
        this.value = this.value.trim();
      });
      
      document.getElementById('nbJoueurs').addEventListener('change', generatePlayerInputs);
    });

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function normaliserNom(nom) {
      return nom.trim().toLowerCase();
    }

    function showInitForm() {
      document.getElementById('initForm').classList.remove('hidden');
      document.getElementById('nbJoueurs').focus();
    }

    function hideInitForm() {
      document.getElementById('initForm').classList.add('hidden');
      document.getElementById('joueursInputs').innerHTML = '';
    }

    function generatePlayerInputs() {
      const n = parseInt(document.getElementById('nbJoueurs').value);
      const container = document.getElementById('joueursInputs');
      container.innerHTML = '';
      
      if (n && n >= 3 && n <= 20) {
        for (let i = 1; i <= n; i++) {
          const div = document.createElement('div');
          div.className = 'joueur-input';
          div.innerHTML = `<input type="text" placeholder="Joueur ${i}">`;
          container.appendChild(div);
          
          div.querySelector('input').addEventListener('input', function() {
            this.value = this.value.trim();
          });
        }
      }
    }

    function commencerPartie() {
      const n = parseInt(document.getElementById('nbJoueurs').value);
      if (!n || n < 3 || n > 20) {
        alert("âŒ Choisissez entre 3 et 20 joueurs");
        return;
      }

      const inputs = document.querySelectorAll('#joueursInputs input');
      const joueurs = [];
      
      for (let i = 0; i < n; i++) {
        const nom = inputs[i].value.trim();
        if (!nom) {
          alert(`âŒ Nom manquant pour le joueur ${i+1}`);
          inputs[i].focus();
          return;
        }
        joueurs.push({
          id: i + 1,
          nom: nom,
          nomNormalise: normaliserNom(nom)
        });
      }

      joueursMeles = shuffle([...joueurs]);
      jeuInitialise = true;
      
      hideInitForm();
      document.getElementById('verifyBtn').classList.remove('hidden');
      document.getElementById('nomInput').focus();
      
      document.getElementById('resultat').textContent = 
        `ğŸ”ª MASSACRE COMMENCÃ‰ - ${n} JOUEURS\n` +
        `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n` +
        `ğŸ“‹ Liste des joueurs :\n${joueurs.map(j => `   â€¢ ${j.nom}`).join('\n')}\n\n` +
        `ğŸ—¡ï¸ Chaque joueur peut dÃ©couvrir sa cible.\n` +
        `âš ï¸  MESSAGE ULTRA SECRET !`;
    }

    function verifier() {
      if (!jeuInitialise || joueursMeles.length === 0) {
        alert("ğŸ‘† Commencez d'abord la partie !");
        return;
      }

      const nomEntree = document.getElementById('nomInput').value.trim();
      if (!nomEntree) {
        alert("âŒ Entrez votre nom");
        return;
      }

      const nomNormalise = normaliserNom(nomEntree);
      const joueur = joueursMeles.find(j => j.nomNormalise === nomNormalise);
      
      if (!joueur) {
        alert("âŒ Joueur '" + nomEntree + "' non trouvÃ©");
        return;
      }

      const index = joueursMeles.indexOf(joueur);
      const cibleIndex = (index + 1) % joueursMeles.length;
      const cible = joueursMeles[cibleIndex].nom;

      // âœ… DÃ‰TECTIVE ğŸ•µï¸â€â™‚ï¸ + COUTEAU ğŸ”ª
      alert(
        `ğŸ•µï¸â€â™‚ï¸ ${joueur.nom}\n` +
        `â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n` +
        `Tu dois Ã‰LIMINER :\nğŸ”ª ${cible}\n\n` +
        `âš ï¸ MESSAGE ULTRA SECRET\n` +
        `âŒ Ne montre Ã  PERSONNE !`
      );
      
      document.getElementById('nomInput').value = '';
      document.getElementById('nomInput').focus();
    }
  </script>
</body>
</html>
